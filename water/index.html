<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Scoreboard</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
            background-color: #f0f0f0;
        }
        h1 {
            margin-bottom: 20px;
        }
        table {
            width: 80%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: center;
        }
        th {
            background-color: #e0e0e0;
        }
        .form-container {
            margin-bottom: 20px;
        }
        .input-group {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .input-group input[type="text"],
        .input-group input[type="number"] {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-right: 10px;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
        }
        .input-group button {
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            background-color: #4caf50;
            color: white;
            font-family: 'Roboto', sans-serif;
            font-size: 16px;
            cursor: pointer;
        }
        .input-group button:hover {
            background-color: #45a049;
        }
        .nested-row {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <h1>Team Scoreboard</h1>
    <div class="form-container">
        <div class="input-group">
            <input type="text" id="teamName" placeholder="Team Name">
            <input type="number" id="correctlyAnalyzed" placeholder="Correct">
            <input type="number" id="incorrectlyAnalyzed" placeholder="Incorrect">
            <input type="text" id="timeTaken" placeholder="Time (min:sec:millisec)">
            <button onclick="addTeam()">Add Team</button>
        </div>
    </div>
    <table id="scoreboard">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Team Name</th>
                <th>Correct</th>
                <th>Incorrect</th>
                <th>Difference</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody>
            <!-- Teams will be added here dynamically -->
        </tbody>
    </table>

    <script>
        let teams = [];

        function addTeam() {
            const teamName = document.getElementById('teamName').value;
            const correctlyAnalyzed = parseInt(document.getElementById('correctlyAnalyzed').value);
            const incorrectlyAnalyzed = parseInt(document.getElementById('incorrectlyAnalyzed').value);
            let timeTaken = document.getElementById('timeTaken').value;

            if (teamName && !isNaN(correctlyAnalyzed) && !isNaN(incorrectlyAnalyzed) && timeTaken) {
                timeTaken = formatTimeInput(timeTaken);
                const correctCount = correctlyAnalyzed - incorrectlyAnalyzed;
                const timeParts = timeTaken.split(':').map(part => parseFloat(part));
                const timeInSeconds = timeParts[0] * 60 + timeParts[1] + timeParts[2] / 1000;

                let existingTeam = teams.find(team => team.name === teamName);

                if (existingTeam) {
                    existingTeam.rounds.push({
                        correct: correctlyAnalyzed,
                        incorrect: incorrectlyAnalyzed,
                        time: timeInSeconds
                    });
                    existingTeam.totalCorrect += correctlyAnalyzed;
                    existingTeam.totalIncorrect += incorrectlyAnalyzed;
                    existingTeam.totalTime += timeInSeconds;
                } else {
                    teams.push({
                        name: teamName,
                        totalCorrect: correctlyAnalyzed,
                        totalIncorrect: incorrectlyAnalyzed,
                        totalTime: timeInSeconds,
                        rounds: [{
                            correct: correctlyAnalyzed,
                            incorrect: incorrectlyAnalyzed,
                            time: timeInSeconds
                        }]
                    });
                }

                updateScoreboard();
            }
        }

        function formatTimeInput(time) {
            let [minutes, seconds, millisec] = time.split(':');
            minutes = minutes.padStart(1, '0');
            seconds = seconds.padStart(2, '0');
            millisec = millisec.padStart(3, '0').slice(0, 3); // Ensure three digits and truncate if more
            return `${minutes}:${seconds}:${millisec}`;
        }

        function updateScoreboard() {
            teams.sort((a, b) => (b.totalCorrect - b.totalIncorrect) - (a.totalCorrect - a.totalIncorrect) || a.totalTime - b.totalTime);

            const tbody = document.getElementById('scoreboard').querySelector('tbody');
            tbody.innerHTML = '';

            teams.forEach((team, index) => {
                const teamRow = document.createElement('tr');
                teamRow.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${team.name} (Total)</td>
                    <td>${team.totalCorrect}</td>
                    <td>${team.totalIncorrect}</td>
                    <td>${team.totalCorrect - team.totalIncorrect}</td>
                    <td>${formatTime(team.totalTime)}</td>
                `;
                tbody.appendChild(teamRow);

                team.rounds.forEach((round, roundIndex) => {
                    const roundRow = document.createElement('tr');
                    roundRow.classList.add('nested-row');
                    roundRow.innerHTML = `
                        <td></td>
                        <td>Round ${roundIndex + 1}</td>
                        <td>${round.correct}</td>
                        <td>${round.incorrect}</td>
                        <td>${round.correct - round.incorrect}</td>
                        <td>${formatTime(round.time)}</td>
                    `;
                    tbody.appendChild(roundRow);
                });
            });
        }

        function formatTime(timeInSeconds) {
            const minutes = Math.floor(timeInSeconds / 60);
            const seconds = Math.floor(timeInSeconds % 60);
            const millisec = Math.floor((timeInSeconds - Math.floor(timeInSeconds)) * 1000);
            return `${minutes}:${seconds.toString().padStart(2, '0')}:${millisec.toString().padStart(3, '0')}`;
        }
    </script>
</body>
</html>
